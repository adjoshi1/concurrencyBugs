{"model_name_or_path": "Llama-3.1-8B-Instruct__t-0.50__p-1.00__c-0.00___adjoshi1__concurrencyBugs-i1", "instance_id": "adjoshi1__concurrencyBugs-i1", "model_patch": "diff --git a/cherokee-0.9.2/bug_prompt.c b/cherokee-0.9.2/bug_prompt.c\nindex 7406618..19495cb 100644\n--- a/cherokee-0.9.2/bug_prompt.c\n+++ b/cherokee-0.9.2/bug_prompt.c\n@@ -96,6 +96,7 @@ ret_t cherokee_buffer_add (cherokee_buffer_t *buf, const char *txt, size_t size)\n \n \t// Copy\n \tmemcpy (buf->buf + buf->len, txt, size);\n+buf->buf[buf->len] = '\\0';\n \n \tbuf->len += size;\n \tbuf->buf[buf->len] = '\\0';\n@@ -104,7 +105,8 @@ ret_t cherokee_buffer_add (cherokee_buffer_t *buf, const char *txt, size_t size)\n }\n \n static void *update_guts (void *arg) {\n-\tcherokee_buffer_add(&cherokee_bogonow_strgmt, txt, strlen(txt));\n+\tmemcpy (cherokee_bogonow_strgmt.buf + cherokee_bogonow_strgmt.len, txt, strlen(txt));\n+cherokee_bogonow_strgmt.buf[cherokee_bogonow_strgmt.len] = '\\0';\n \treturn NULL;\n }\n \n@@ -116,7 +118,9 @@ int main() {\n \tfor (int i = 0; i < 10; i++) {\n \t\tpthread_t thread1, thread2;\n \n-\t\tcherokee_buffer_clean(&cherokee_bogonow_strgmt);\n+\t\tpthread_mutex_lock(&lock);\n+cherokee_buffer_clean(&cherokee_bogonow_strgmt);\n+pthread_mutex_unlock(&lock);\n \t\tpthread_create(&thread1, NULL, update_guts, NULL);\n \t\tpthread_create(&thread2, NULL, update_guts, NULL);\n \n@@ -124,6 +128,7 @@ int main() {\n \t\tpthread_join(thread2, NULL);\n \n \t\tprintf(\"Run %d: buf = %s, len = %d \\n\", i, cherokee_bogonow_strgmt.buf, cherokee_bogonow_strgmt.len);\n+cherokee_buffer_clean(&cherokee_bogonow_strgmt);\n \t}\n \n \treturn 0;\n"}